"use strict";(self["webpackChunkmairi"]=self["webpackChunkmairi"]||[]).push([[573],{3367:(e,t,n)=>{n.d(t,{j:()=>i});var a=n(1959),o=n(7645);const r=[{id:"餅よもぎ",name:"餅よもぎ",kana:"もちよもぎ",born:new Date("1985-08-28T00:00:00+09:00"),title:"同人声優",rip:new Date("2016-04-01T00:00:00+09:00")}];class s{constructor(){this.db=(0,a.qj)({persons:r})}getMonth(e){return e.getMonth()+1}getUruDaysDelta(e,t){let n=0;function a(e){return e%4==0&&!(e%100==0)}for(let o=e.getFullYear();o<=t.getFullYear();o++)o==e.getFullYear()?a(o)&&this.getMonth(e)<=2&&n++:o==t.getFullYear()?a(o)&&(this.getMonth(t)>2||2==this.getMonth(t)&&29==t.getDate())&&n++:a(o)&&n++;return n}nextHoyoDays(e,t=new Date){const n=this.nextHoyoDate(e,t);return o.ZP.getDateDiff(n,t),o.ZP.getDateDiff(n,t)}nextHoyoDate(e,t=new Date){const n=new Date(`${t.getFullYear()}-${o.ZP.formatDate(e,"MM")}-${o.ZP.formatDate(e,"DD")}`);return t>n&&n.setFullYear(n.getFullYear()+1),n}getYearDaysDiff(e,t){const n=o.ZP.getDateDiff(e,t),a=~~(n/365),r=this.getUruDaysDelta(t,e),s=(n-r)%365;return{year:a,days:s}}getNowAge(e,t=new Date){const n=o.ZP.getDateDiff(t,e),a=this.getUruDaysDelta(e,t),r=~~((n-a)/365);return r}static get getInstance(){return this.instance||(this.instance=new s),this.instance}}function i(){return s.getInstance}},1573:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var a=n(3673),o=n(2323);const r={class:"text-h4"},s={class:"text-subtitle1"},i={class:"text-subtitle1"},u={class:"text-subtitle1"},l=(0,a._)("div",{class:"text-h6"},"線香",-1),c=(0,a._)("div",{class:"text-h6"},"メッセージ",-1),d=(0,a._)("div",{class:"text-caption"},"※メッセージは送信すると煙の様に消えます。保存はされないのでご注意を。",-1);function p(e,t,n,p,D,f){const g=(0,a.up)("q-card-section"),h=(0,a.up)("q-card"),w=(0,a.up)("kouro"),m=(0,a.up)("q-input"),y=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(y,{class:"text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{flat:"",class:"profile-box"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a._)("div",r,(0,o.zw)(e.person.name),1),(0,a._)("div",s,(0,o.zw)(e.person.kana),1),(0,a._)("div",i,(0,o.zw)(e.date.formatDate(e.person.born,"YYYY"))+" - "+(0,o.zw)(e.date.formatDate(e.person.rip,"YYYY")),1),(0,a._)("div",u,(0,o.zw)(e.person.title),1)])),_:1}),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a._)("div",null,(0,o.zw)(`亡くなってから${e.sinceAfterRip.year}年${e.sinceAfterRip.days}日が過ぎました。`),1),(0,a._)("div",null,(0,o.zw)(`${e.Profile.getNowAge(e.person.born,e.person.rip)}歳で亡くなりました。現在の年齢は${e.Profile.getNowAge(e.person.born)}歳です。`),1),(0,a._)("div",null,(0,o.zw)(`${e.date.formatDate(e.person.born,"YYYY年MM月DD日")}に誕生、${e.date.formatDate(e.person.rip,"YYYY年MM月DD日")}に亡くなりました。`),1),(0,a._)("div",null,(0,o.zw)(`次の法要は${e.Profile.nextHoyoDays(e.person.rip)}日後、${e.date.formatDate(e.Profile.nextHoyoDate(e.person.rip),"YYYY年MM月DD日")}です。`),1)])),_:1})])),_:1}),(0,a.Wm)(h,{flat:"",class:"profile-box"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[l])),_:1}),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{person:e.person},null,8,["person"])])),_:1}),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[c,(0,a.Wm)(m,{type:"textarea",outlined:""}),d,(0,a._)("button",{onClick:t[0]||(t[0]=t=>e.submitMessage())},"送信")])),_:1})])),_:1})])),_:1})}var D=n(1959),f=n(3367),g=n(7645);const h=e=>((0,a.dD)("data-v-5a76f846"),e=e(),(0,a.Cn)(),e),w={style:{width:"300px",height:"300px",margin:"0 auto"}},m={viewBox:"0 0 1000.0 1000.0"},y=h((()=>(0,a._)("image",{style:{width:"1000px",height:"1000px"},"xlink:href":"/img/kouro.png"},null,-1))),x=["x1","y1","x2","y2","stroke"],k=["x1","y1","x2","y2"];function b(e,t,n,o,r,s){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",w,[((0,a.wg)(),(0,a.iD)("svg",m,[y,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.kouro.db.senkou,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e},[(0,a._)("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.color,"stroke-width":"2"},null,8,x),(0,a._)("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y1-20,stroke:"orange","stroke-width":"3"},null,8,k)],64)))),128))]))]),(0,a._)("button",{onClick:t[0]||(t[0]=t=>e.kouro.addSenkou())},"線香を上げる")])}var v=n(8127),Y=n(5720),_=n(2358);const M={apiKey:"AIzaSyCzsQdEVKWSMitDrF4Druvs_43ymKnGzB0",authDomain:"mairi-9a55f.firebaseapp.com",projectId:"mairi-9a55f",storageBucket:"mairi-9a55f.appspot.com",messagingSenderId:"246547280380",appId:"1:246547280380:web:64c3e24480865582dc4279",measurementId:"G-VLPFN9DVQB"},P=M,Z=(0,Y.ZF)(P),I=(0,v.ad)(Z);new _.go((0,v.ad)(Z));var z=function(e,t,n,a){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function s(e){try{u(a.next(e))}catch(t){r(t)}}function i(e){try{u(a["throw"](e))}catch(t){r(t)}}function u(e){e.done?n(e.value):o(e.value).then(s,i)}u((a=a.apply(e,t||[])).next())}))};new Date;class F{constructor(e){this.db=(0,D.qj)({senkou:[]}),this.syncKouroWithFirebase(e)}senkouIsOdd(){return this.db.senkou.length%2==0}getRandomSenkou(e="green"){const t=Math.floor(151*Math.random()),n=t%10>=6?t:t+5,a=20;return 0==this.db.senkou.length?{x1:500,x2:500,y1:305,y2:605,color:e,putDate:new Date}:this.db.senkou.length%2==0?{x1:500+n,x2:500+n,y1:305+t%a,y2:605+t%a,color:e,putDate:new Date}:{x1:500-n,x2:500-n,y1:305+t%a,y2:605+t%a,color:e,putDate:new Date}}addSenkou(e="green"){this.db.senkou.push(this.getRandomSenkou(e))}startUpdateKouro(){const e=6e4;function t(t,n){return new Date(t.getTime()+n*e)}setInterval((()=>{this.db.senkou=this.db.senkou.filter((e=>new Date<t(e.putDate,30))),this.db.senkou=this.db.senkou.map((e=>{const t=new Date;t.getTime(),e.putDate.getTime();return e.y1+10<e.y2&&(e.y1+=10),e}))}),e)}syncKouroWithFirebase(e,t=new Date){return z(this,void 0,void 0,(function*(){const n=(0,v.IO)((0,v.hJ)(I,`/mairi/v1/person/${e.id}/kouro`),(0,v.ar)("putDate",">",v.EK.fromDate(new Date(t.getTime()-12e5)))),a=(yield(0,v.PL)(n)).docs.map((e=>e.data())).map((e=>(e.putDate=e.putDate.toDate(),e)));console.log("syncKouro",e.id,a),this.db.senkou=a}))}static getInstance(e){return this.instance||(this.instance=new F(e),this.instance.startUpdateKouro()),this.instance}}function W(e){return F.getInstance(e)}const $=["green","pink","gray"],K=(0,a.aZ)({props:{person:{type:Object,required:!0}},setup(e){const t=(0,D.iH)($[0]),n=W(e.person);return{kouro:n,colors:$,color:t}}});var H=n(4260);const S=(0,H.Z)(K,[["render",b],["__scopeId","data-v-5a76f846"]]),j=S,C=["ふと思い出してしまうのはどうしてでしょうか。\n悲しくて堪らなくて、もう2度と聞けないと思っていたあなたの声を集め直しました。やはり、悲しくて最後まで聞けませんでした。こんなにも素敵なものを生み出してくれてありがとうございます。受け入れられない私をどうか許してください。","ふと思い出してしまうのはどうしてでしょうか。","ふと思い出してしまうのはどうしてでしょうか。悲しくて堪らなくて、もう2度と聞けないと思っていたあなたの声を集め直しました。やはり、悲しくて最後まで聞けませんでした。こんなにも素敵なものを生み出してくれてありがとうございます。受け入れられない私をどうか許してください。","ふと思い出してしまうのはどうしてでしょうか。悲しくて堪らなくて、もう2度と聞けないと思っていたあなたの声を集め直しました。やはり、悲しくて最後まで聞けませんでした。こんなにも素敵なものを生み出してくれてありがとうございます。","ふと思い出してしまうのはどうしてでしょうか。悲しくて堪らなくて、もう2度と聞けないと思っていたあなたの声を集め直しました。やはり、悲しくて最後まで聞けませんでした。こんなにも素敵なものを生み出してくれてありがとうございます。受け入れられない私をどうか許してください。","ふと思い出してしまうのはどうしてでしょうか。悲しくて堪らなくて、もう2度と聞けないと思っていたあなたの声を集め直しました。やはり、悲しくて最後まで聞けませんでした。こんなにも素敵なものを生み出してくれてありがとうございます。受け入れられない私をどうか許してください。"],q=(0,a.aZ)({components:{Kouro:j},props:{name:String},setup(e){const t=(0,f.j)().db.persons.filter((t=>t.name==e.name)),n=t[0],a=(0,f.j)(),o=a.getYearDaysDiff(new Date,n.rip);let r=(0,D.iH)("");function s(){0==r.value.length||(r.value="")}return{submitMessage:s,date:g.ZP,person:n,message:r,text:C,Profile:a,sinceAfterRip:o}}});var A=n(4379),Q=n(151),T=n(5589),R=n(1439),U=n(7518),B=n.n(U);const N=(0,H.Z)(q,[["render",p]]),O=N;B()(q,"components",{QPage:A.Z,QCard:Q.Z,QCardSection:T.Z,QInput:R.Z})}}]);